@model DEPI_Donation.Models.Activity

@{
    ViewData["Title"] = "Create Activity";
}

<h1>Create Activity</h1>

<h4>Activity</h4>
<hr />

<form id="createActivityForm">
    <div class="form-group">
        <label for="Title">Title</label>
        <input type="text" class="form-control" id="Title" name="Title" />
        <span class="text-danger" id="TitleError"></span>
    </div>

    <div class="form-group">
        <label for="Description">Description</label>
        <input type="text" class="form-control" id="Description" name="Description" />
        <span class="text-danger" id="DescriptionError"></span>
    </div>

    <div class="form-group">
        <label for="Category">Category</label>
        <input type="text" class="form-control" id="Category" name="Category" />
        <span class="text-danger" id="CategoryError"></span>
    </div>

    <div class="form-group">
        <label for="TargetAmount">Target Amount</label>
        <input type="number" class="form-control" id="TargetAmount" name="TargetAmount" />
        <span class="text-danger" id="TargetAmountError"></span>
    </div>

    <div class="form-group">
        <label for="StartDate">Start Date</label>
        <input type="date" class="form-control" id="StartDate" name="StartDate" />
        <span class="text-danger" id="StartDateError"></span>
    </div>

    <div class="form-group">
        <label for="EndDate">End Date</label>
        <input type="date" class="form-control" id="EndDate" name="EndDate" />
        <span class="text-danger" id="EndDateError"></span>
    </div>

    <div class="form-group">
        <label for="Status">Status</label>
        <input type="text" class="form-control" id="Status" name="Status" />
        <span class="text-danger" id="StatusError"></span>
    </div>

    <button type="submit" class="btn btn-primary">Create</button>
</form>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        $('#createActivityForm').on('submit', function (e) {
            e.preventDefault(); // Prevent the default form submission

            // Clear previous error messages
            $('.text-danger').text('');

            // Gather form data
            var formData = {
                Title: $('#Title').val(),
                Description: $('#Description').val(),
                Category: $('#Category').val(),
                TargetAmount: $('#TargetAmount').val(),
                StartDate: $('#StartDate').val(),
                EndDate: $('#EndDate').val(),
                Status: $('#Status').val()
            };

            // Send the data to the server using AJAX
            $.ajax({
                url: '@Url.Action("Create", "Activity")', // Controller action URL
                type: 'POST',
                data: formData,
                success: function (response) {
                    if (response.success) {
                        alert('Activity created successfully!');
                        window.location.href = '@Url.Action("Index", "Activity")'; // Redirect to the index page
                    } else {
                        alert('Error: ' + response.message);
                    }
                },
                error: function (xhr, status, error) {
                    alert('An error occurred: ' + error);
                }
            });
        });
    });
</script>
